#!/bin/sh

wc=$(echo $* | wc -w)
if [ "$wc" -eq "0" ]; then
  echo "> please enter a valid path and extension"
  exit 1
elif [ "$wc" -eq "1" ]; then
  extension="\*"
else
  extension=$2
fi

list () 
{
  file=$1
  nol=3
  ln=$(cat -n $file | grep TODO | cut -f 1) 
  for x in $ln
  do
    echo "____________"
    echo "**$file $x**"
    echo "\`\`\`c"
    head -$(echo $x + $nol | bc) $file | tail -$(echo $nol+$nol+1 | bc)
    echo "\`\`\` "
  done
}

echo "> generated by todofinder" > TODOS_.md
echo "# TODOS" >> TODOS_.md
echo " " >> TODOS_.md
for x in $(find $1 -type f -name "*\.$extension")
do 
  list $x >> TODOS_.md
done
